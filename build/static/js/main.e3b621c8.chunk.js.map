{"version":3,"sources":["app/hooks.ts","app/Videos/videosApi.ts","app/Videos/videosSlice.ts","app/SearchBar/SearchBar.tsx","app/SearchResults/SearchResults.tsx","app/Upload/UploadHelpers.ts","app/Upload/uploadSlice.ts","app/LoginReg/Login/loginApi.ts","app/LoginReg/Login/loginSlice.ts","app/Upload/Upload.tsx","app/Home/Home.tsx","app/OneVideo/oneVideoApi.ts","app/OneVideo/oneVideoSlice.ts","app/OneVideo/OneVideo.tsx","app/LoginReg/Login/LoginReg.tsx","App.tsx","features/counter/counterAPI.ts","features/counter/counterSlice.ts","app/store.ts","serviceWorker.ts","index.tsx"],"names":["useAppDispatch","useDispatch","useAppSelector","useSelector","getVideosFromAPI","Promise","resolve","axios","get","then","data","getSearchVideosFromAPI","query","getVideosFromApiAsync","createAsyncThunk","a","response","getSearchVideosFromApiAsync","videosSlice","createSlice","name","initialState","status","videos","searchClicks","reducers","setVideos","state","payload","pushSearchClick","extraReducers","builder","addCase","pending","fulfilled","action","actions","getVideos","getSearchHistory","SearchBar","useState","searchStr","setSearchStr","history","useHistory","dispatch","style","display","textAlign","onSubmit","e","preventDefault","push","encodeURIComponent","type","value","onChange","event","target","SearchResults","params","useParams","searchParams","decodeURIComponent","allVideos","searchHistory","useEffect","rows","map","video","className","padding","onClick","id","_id","src","title","author","views","b64toBlob","dataURI","byteString","atob","split","ab","ArrayBuffer","length","ia","Uint8Array","i","charCodeAt","Blob","postVideo","token","formData","FormData","append","localStorage","username","description","thumbnailGifs","thumbnailGifsIndex","url","blob","fileName","post","headers","res","uploadSlice","thumbnailPngsIndex","thumbnailPngs","setAuthor","setTitle","setDescription","setUrl","setFilename","setThumbnailGifsIndex","setThumbnailGifs","setThumbnailPngsIndex","setThumbnailPngs","setStatus","setVideo","selectAuthor","upload","selectDescription","selectFilename","selectThumbnailGifsIndex","selectThumbnailGifs","selectThumbnailPngsIndex","selectThumbnailPngs","selectTitle","selectUploadState","selectVideo","loginFromApi","password","errors","loggedIn","undefined","expiresAt","Date","now","document","cookie","loginFromApiAsync","loginSlice","setUsername","setPassword","setUsernameError","param","setPasswordError","setLoggedIn","setToken","selectLoginState","login","selectUsername","selectPassword","selectUsernameErrors","selectPasswordErrors","selectLoggedIn","selectToken","ffmpeg","createFFmpeg","log","Upload","handleFile","files","file","startsWith","videoElement","createElement","addEventListener","convertToGif","duration","URL","createObjectURL","load","fileReader","FileReader","onload","result","readAsDataURL","isLoaded","handleTestFile","fetchFile","FS","num_gifs","gifs","Array","pngs","fps_str","run","start_strs","midpoint","start_int","Math","max","end_int","min","start_str","toString","gif_name","gif_0","buffer","gif_1","gif_2","gif_3","png_0","png_1","png_2","png_3","videoUploadDiv","accept","color","height","opacity","justifyContent","Home","getOneVideoFromAPI","getOneVideoFromApiAsync","oneVideoSlice","getVideo","oneVideo","OneVideo","controls","paddingRight","date","toDateString","likes","Login","loginState","errorsUsername","errorsPassword","handleChange","inputName","newStr","setItem","expiresIn","App","to","paddingTop","exact","path","fetchCount","amount","setTimeout","incrementAsync","counterSlice","increment","decrement","incrementByAmount","store","configureStore","reducer","counter","counterReducer","uploadReducer","videosReducer","oneVideoReducer","loginReducer","Boolean","window","location","hostname","match","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.e3b621c8.chunk.js","sourcesContent":["import { TypedUseSelectorHook, useDispatch, useSelector } from 'react-redux';\nimport type { RootState, AppDispatch } from './store';\n\n// Use throughout your app instead of plain `useDispatch` and `useSelector`\nexport const useAppDispatch = () => useDispatch<AppDispatch>();\nexport const useAppSelector: TypedUseSelectorHook<RootState> = useSelector;\n","import axios, {AxiosResponse} from \"axios\";\r\nimport {VideoDataResponse} from \"./VideoInterfaces\";\r\n\r\nexport function getVideosFromAPI(){\r\n    return new Promise<AxiosResponse<VideoDataResponse>>((resolve) => {\r\n        axios.get(\"/api/video/all\").then((data:AxiosResponse<VideoDataResponse>) =>{\r\n            resolve(data)\r\n        })\r\n    })\r\n}\r\n\r\nexport function getSearchVideosFromAPI(query: string){\r\n    return new Promise<AxiosResponse<VideoDataResponse>>((resolve) => {\r\n        axios.get(`/api/video/search/${query}`).then((data:AxiosResponse<VideoDataResponse>) =>{\r\n            resolve(data)\r\n        })\r\n    })\r\n}","import {createAsyncThunk, createSlice, PayloadAction} from '@reduxjs/toolkit';\r\nimport {RootState, AppThunk} from '../../app/store';\r\nimport axios, {AxiosResponse} from 'axios'\r\nimport {VideoDataResponse} from \"./VideoInterfaces\";\r\nimport {Video} from \"./VideoInterfaces\";\r\nimport {getSearchVideosFromAPI, getVideosFromAPI} from \"./videosApi\";\r\n\r\nexport interface VideosState {\r\n    status: string,\r\n    videos: Video[],\r\n    searchClicks: number[]\r\n}\r\n\r\nconst initialState: VideosState = {\r\n    status: \"\",\r\n    videos: [],\r\n    searchClicks: [0]\r\n};\r\n// The function below is called a thunk and allows us to perform async logic. It\r\n// can be dispatched like a regular action: `dispatch(incrementAsync(10))`. This\r\n// will call the thunk with the `dispatch` function as the first argument. Async\r\n// code can then be executed and other actions can be dispatched. Thunks are\r\n// typically used to make async requests.\r\nexport const getVideosFromApiAsync = createAsyncThunk(\r\n    'videos/getVideosFromApi',\r\n    async () => {\r\n        const response = await getVideosFromAPI();\r\n        // The value we return becomes the `fulfilled` action payload\r\n        return response.data;\r\n    }\r\n);\r\nexport const getSearchVideosFromApiAsync = createAsyncThunk(\r\n    'videos/getSearchVideosFromApi',\r\n    async (query: string) => {\r\n        const response = await getSearchVideosFromAPI(query);\r\n        // The value we return becomes the `fulfilled` action payload\r\n        return response.data;\r\n    }\r\n);\r\nexport const getOneVideoFromApiAsync = createAsyncThunk(\r\n    'video/getOneVideoFromApi',\r\n    async () => {\r\n        const response = await getVideosFromAPI();\r\n        // The value we return becomes the `fulfilled` action payload\r\n        return response.data;\r\n    }\r\n)\r\n\r\n\r\nexport const videosSlice = createSlice({\r\n    name: 'upload',\r\n    initialState,\r\n    // The `reducers` field lets us define reducers and generate associated actions\r\n    reducers: {\r\n        setVideos: (state, videos: PayloadAction<Video[]>) => {\r\n            state.videos = videos.payload\r\n        },\r\n        pushSearchClick: (state) => {\r\n            state.searchClicks[0] = (state.searchClicks[0] + 1) % 3\r\n        }\r\n    },\r\n    extraReducers: (builder) => {\r\n        builder\r\n            .addCase(getVideosFromApiAsync.pending, (state) => {\r\n                state.status = 'loading';\r\n            })\r\n            .addCase(getVideosFromApiAsync.fulfilled, (state, action) => {\r\n                state.status = 'idle';\r\n                state.videos = action.payload.videos;\r\n            })\r\n            .addCase(getSearchVideosFromApiAsync.pending, (state, action) => {\r\n                state.status = 'loading';\r\n                state.videos = [];\r\n            })\r\n            .addCase(getSearchVideosFromApiAsync.fulfilled, (state, action) => {\r\n                state.status = 'idle';\r\n                state.videos = action.payload.videos;\r\n            })\r\n    },\r\n\r\n    // author: \"\",\r\n    // description: \"\",\r\n    // thumbnail: \"\",\r\n    // status: 'idle',\r\n    // title: \"\",\r\n    // url: \"\",\r\n    // video: \"\"\r\n    // getVideosReq: (state) => {\r\n    //     axios.get(\"/api/video/all\").then((data:AxiosResponse<VideoDataResponse>) => {\r\n    //         state.videos = data.data.videos\r\n    //         console.log(data)\r\n    //     })\r\n    // }\r\n})\r\n// author: \"\",\r\n//     description: \"\",\r\n//     thumbnail: \"\",\r\n//     status: 'idle',\r\n//     title: \"\",\r\n//     url: \"\",\r\n//     video: \"\"\r\nexport const {\r\n    setVideos,\r\n    pushSearchClick\r\n} = videosSlice.actions;\r\n\r\n// The function below is called a selector and allows us to select a value from\r\n// the state. Selectors can also be defined inline where they're used instead of\r\n// in the slice file. For example: `useSelector((state: RootState) => state.counter.value)`\r\nexport const getVideos = (state: RootState) => state.videos.videos;\r\nexport const getSearchHistory = (state: RootState) => state.videos.searchClicks\r\n\r\n\r\nexport default videosSlice.reducer;\r\n","import React, {ChangeEvent, useState} from \"react\";\r\nimport {useHistory} from \"react-router-dom\";\r\nimport {useAppDispatch} from \"../hooks\";\r\nimport {pushSearchClick} from \"../Videos/videosSlice\";\r\n\r\nexport function SearchBar(){\r\n    const [searchStr, setSearchStr] = useState(\"\")\r\n    const history = useHistory()\r\n    const dispatch = useAppDispatch()\r\n\r\n    function handleChange(event: ChangeEvent<HTMLInputElement>){\r\n        event.preventDefault()\r\n        setSearchStr(event.target.value)\r\n    }\r\n    function onClickButton(){\r\n        history.push(`/results/search_query=${encodeURIComponent(searchStr)}`)\r\n        dispatch(pushSearchClick())\r\n    }\r\n\r\n    return (\r\n        <div style={{display: \"inline-block\", textAlign:\"center\"}}>\r\n            <form onSubmit={(e) => { e.preventDefault(); onClickButton()}}>\r\n                <input type={\"text\"} value={searchStr} onChange={handleChange}/><button>Search</button>\r\n            </form>\r\n        </div>\r\n    )\r\n}","import {useHistory, useParams} from \"react-router-dom\"\r\nimport './SearchResults.scss'\r\nimport {useEffect} from \"react\";\r\nimport {useAppDispatch, useAppSelector} from \"../hooks\";\r\nimport {getSearchHistory, getSearchVideosFromApiAsync, getVideos, setVideos} from \"../Videos/videosSlice\";\r\nimport {getSearchVideosFromAPI} from \"../Videos/videosApi\";\r\n\r\ninterface QueryParams {\r\n    query: string\r\n}\r\n\r\nexport function SearchResults(){\r\n    const params:QueryParams = useParams()\r\n    const searchParams = decodeURIComponent(params.query)\r\n    const dispatch = useAppDispatch()\r\n    const allVideos = useAppSelector(getVideos)\r\n    const searchHistory = useAppSelector(getSearchHistory)\r\n    const history = useHistory()\r\n\r\n    useEffect(() => {\r\n        dispatch(setVideos([]))\r\n        dispatch(getSearchVideosFromApiAsync(searchParams))\r\n    }, searchHistory)\r\n\r\n    function onClickVideo(id:string){\r\n        history.push(`/watch/${id}`)\r\n    }\r\n\r\n    const rows = allVideos.map((video) => {\r\n        return (\r\n            <div className={\"searchrow\"} style={{padding: \"20px 0px 20px 0px\"}} onClick={() => onClickVideo(video._id)}>\r\n                {/*<img src={video.thumbnail}/>*/}<img src={\"https://getuikit.com/v2/docs/images/placeholder_600x400.svg\"}/>\r\n                <div className={\"videoinfo\"}>{video.title} <br/>\r\n                    {video.author} <br/>\r\n                    {video.views} <br/>\r\n\r\n                </div>\r\n            </div>\r\n        )\r\n    })\r\n    return (\r\n        <div className={\"grid\"}>\r\n            {/*<div style={{gridColumnEnd: 2}}>*/}\r\n            <div id={\"sidebar\"}>\r\n                Sidebar\r\n            </div>\r\n            <div id={\"searchrows\"}>\r\n                {rows}\r\n            </div>\r\n        </div>\r\n    )\r\n}","export function b64toBlob(dataURI: string) {\r\n    var byteString = atob(dataURI.split(',')[1]);\r\n    var ab = new ArrayBuffer(byteString.length);\r\n    var ia = new Uint8Array(ab);\r\n\r\n    for (var i = 0; i < byteString.length; i++) {\r\n        ia[i] = byteString.charCodeAt(i);\r\n    }\r\n    return new Blob([ab], {type: 'video/webm'});\r\n}\r\n","import {createAsyncThunk, createSlice, PayloadAction} from '@reduxjs/toolkit';\r\nimport {RootState, AppThunk} from '../../app/store';\r\nimport axios from 'axios'\r\nimport {useHistory} from \"react-router-dom\";\r\nimport {loginFromApi} from \"../LoginReg/Login/loginApi\";\r\nimport {LoginState} from \"../LoginReg/Login/loginSlice\";\r\nimport {b64toBlob} from \"./UploadHelpers\";\r\n\r\n\r\nexport interface UploadState {\r\n    author: string,\r\n    description: string,\r\n    fileName: string,\r\n    thumbnailGifsIndex: string,\r\n    thumbnailGifs: string[],\r\n    thumbnailPngsIndex: string,\r\n    thumbnailPngs: string[],\r\n    status: 'idle' | 'uploading' | 'successful' | 'failed'\r\n    title: string,\r\n    url: string,\r\n    video: string\r\n}\r\n\r\nconst initialState: UploadState = {\r\n    author: \"\",\r\n    description: \"\",\r\n    fileName: \"Upload\",\r\n    status: 'idle',\r\n    thumbnailGifsIndex: \"0\",\r\n    thumbnailGifs: [\"\",\"\",\"\",\"\"],\r\n    thumbnailPngsIndex: \"\",\r\n    thumbnailPngs: [\"\",\"\",\"\",\"\"],\r\n    title: \"\",\r\n    url: \"\",\r\n    video: \"\",\r\n};\r\n\r\ninterface postRequestData {\r\n    state: UploadState,\r\n    token: string,\r\n    history: any\r\n}\r\n\r\nexport const postVideo = createAsyncThunk(\r\n    'upload/postVideo',\r\n    async (data: postRequestData) => {\r\n        const {state, token, history} = data\r\n        if (state.video === \"\") return;\r\n        const formData = new FormData()\r\n        formData.append(\"author\", localStorage.username)\r\n        formData.append(\"description\", state.description)\r\n        formData.append(\"thumbnail\", state.thumbnailGifs[state.thumbnailGifsIndex as unknown as number])\r\n        formData.append(\"status\", state.status)\r\n        formData.append(\"title\", state.title)\r\n        formData.append(\"url\", state.url)\r\n        const blob = b64toBlob(state.video)\r\n        formData.append(\"video\", blob, state.fileName)\r\n        axios.post(\"/api/video\", formData, {\r\n            headers: {\r\n                'token': token,\r\n                'author': localStorage.username\r\n            }\r\n        }).then((res) => {\r\n            if (res.data.status === \"successful\") {\r\n                // File is not uploaded synchronously\r\n                // TODO: Query the upload until it is available..\r\n                // history.push(`watch/${res.data.video._id}`)\r\n                history.push(`/`)\r\n            } else {\r\n                history.push('/login')\r\n            }\r\n        })\r\n    }\r\n)\r\n\r\n\r\n\r\nexport const uploadSlice = createSlice({\r\n    name: 'upload',\r\n    initialState,\r\n    // The `reducers` field lets us define reducers and generate associated actions\r\n    reducers: {\r\n        setAuthor: (state, action: PayloadAction<string>) => {\r\n            state.author = action.payload\r\n        },\r\n        //Add payload here\r\n        setTitle: (state, action: PayloadAction<string>) => {\r\n            state.title = action.payload\r\n        },\r\n        setDescription: (state, action: PayloadAction<string>) => {\r\n            state.description = action.payload\r\n        },\r\n        setUrl: (state, action: PayloadAction<string>) => {\r\n            state.url = action.payload\r\n        },\r\n        setFilename: (state, action: PayloadAction<string>) => {\r\n            state.fileName = action.payload\r\n        },\r\n        setThumbnailGifsIndex: (state, action: PayloadAction<string>) => {\r\n            state.thumbnailGifsIndex = action.payload\r\n        },\r\n        setThumbnailGifs: (state, action: PayloadAction<string[]>) => {\r\n            state.thumbnailGifs = action.payload\r\n        },\r\n        setThumbnailPngsIndex: (state, action: PayloadAction<string>) => {\r\n            state.thumbnailPngsIndex = action.payload\r\n        },\r\n        setThumbnailPngs: (state, action: PayloadAction<string[]>) => {\r\n            state.thumbnailPngs = action.payload\r\n        },\r\n        setStatus: (state, action: PayloadAction<'idle' | 'uploading' | 'successful' | 'failed'>) => {\r\n            state.status = action.payload\r\n        },\r\n        setVideo: (state, action: PayloadAction<string>) => {\r\n            state.video = action.payload\r\n        },\r\n    }\r\n})\r\n\r\nexport const {\r\n    setAuthor,\r\n    setDescription,\r\n    setFilename,\r\n    setStatus,\r\n    setThumbnailGifsIndex,\r\n    setThumbnailGifs,\r\n    setThumbnailPngsIndex,\r\n    setThumbnailPngs,\r\n    setTitle,\r\n    setUrl,\r\n    setVideo,\r\n} = uploadSlice.actions;\r\n\r\n// The function below is called a selector and allows us to select a value from\r\n// the state. Selectors can also be defined inline where they're used instead of\r\n// in the slice file. For example: `useSelector((state: RootState) => state.counter.value)`\r\nexport const selectAuthor = (state: RootState) => state.upload.author;\r\nexport const selectDescription = (state: RootState) => state.upload.description;\r\nexport const selectFilename = (state: RootState) => state.upload.fileName;\r\nexport const selectStatus = (state: RootState) => state.upload.status;\r\nexport const selectThumbnailGifsIndex = (state: RootState) => state.upload.thumbnailGifsIndex;\r\nexport const selectThumbnailGifs = (state: RootState) => state.upload.thumbnailGifs;\r\nexport const selectThumbnailPngsIndex = (state: RootState) => state.upload.thumbnailPngsIndex;\r\nexport const selectThumbnailPngs = (state: RootState) => state.upload.thumbnailPngs;\r\nexport const selectTitle = (state: RootState) => state.upload.title;\r\nexport const selectUploadState = (state: RootState) => state.upload;\r\nexport const selectUrl = (state: RootState) => state.upload.url;\r\nexport const selectVideo = (state: RootState) => state.upload.video;\r\n\r\n\r\nexport default uploadSlice.reducer;\r\n","import axios, {AxiosResponse} from \"axios\";\r\nimport {LoginResponse} from \"./LoginInterface\";\r\n\r\nexport function loginFromApi(username: string, password: string) {\r\n    return new Promise<AxiosResponse<LoginResponse>>((resolve) => {\r\n        axios.post(\"api/login/login\", {username: username, password: password}).then((data: AxiosResponse<LoginResponse>) => {\r\n            resolve(data)\r\n        })\r\n    })\r\n}","import {createAsyncThunk, createSlice, PayloadAction} from '@reduxjs/toolkit';\r\nimport axios, {AxiosResponse} from 'axios'\r\nimport {getOneVideoFromAPI} from \"../../OneVideo/oneVideoApi\";\r\nimport {loginFromApi} from \"./loginApi\";\r\nimport {LoginResponse} from \"./LoginInterface\";\r\nimport {RootState} from \"../../store\";\r\n\r\nexport interface LoginErrors {\r\n    username: string,\r\n    password: string\r\n}\r\n\r\nexport interface LoginState {\r\n    status: string,\r\n    username: string,\r\n    password: string,\r\n    errors: LoginErrors,\r\n    loggedIn: boolean,\r\n    token: string\r\n}\r\n\r\nconst initialState: LoginState = {\r\n    status: \"\",\r\n    username: \"user\",\r\n    password: \"pass\",\r\n    errors: {\r\n        username: \"\",\r\n        password: \"\"\r\n    },\r\n    loggedIn: checkIfLoggedIn(),\r\n    token: (!!localStorage.username || !!document.cookie) ? document.cookie : \"\"\r\n};\r\n\r\nfunction checkIfLoggedIn() {\r\n    if (localStorage.expiresAt === undefined || localStorage.expiresAt < Date.now()) {\r\n        document.cookie = \"\"\r\n        return false\r\n    } else {\r\n        return true;\r\n    }\r\n\r\n}\r\n\r\n// The function below is called a thunk and allows us to perform async logic. It\r\n// can be dispatched like a regular action: `dispatch(incrementAsync(10))`. This\r\n// will call the thunk with the `dispatch` function as the first argument. Async\r\n// code can then be executed and other actions can be dispatched. Thunks are\r\n// typically used to make async requests.\r\nexport const loginFromApiAsync = createAsyncThunk(\r\n    'login/loginFromApi',\r\n    async (state: LoginState) => {\r\n        const response = await loginFromApi(state.username, state.password);\r\n        // // The value we return becomes the `fulfilled` action payload\r\n        return response.data;\r\n    }\r\n);\r\n\r\nexport const loginSlice = createSlice({\r\n    name: 'login',\r\n    initialState,\r\n    // The `reducers` field lets us define reducers and generate associated actions\r\n    reducers: {\r\n        setUsername: (state, username: PayloadAction<string>) => {\r\n            state.username = username.payload\r\n        },\r\n        setPassword: (state, password: PayloadAction<string>) => {\r\n            state.password = password.payload\r\n        },\r\n        setUsernameError: (state, param: PayloadAction<string>) => {\r\n            state.errors.username = param.payload\r\n        },\r\n        setPasswordError: (state, param: PayloadAction<string>) => {\r\n            state.errors.password = param.payload\r\n        },\r\n        setLoggedIn: (state, param: PayloadAction<boolean>) => {\r\n            state.loggedIn = param.payload\r\n        },\r\n        setToken: (state, param: PayloadAction<string>) => {\r\n            state.token = param.payload\r\n        }\r\n\r\n    },\r\n    extraReducers: (builder) => {\r\n        builder\r\n            .addCase(loginFromApiAsync.pending, (state) => {\r\n                state.status = 'loading';\r\n            })\r\n            .addCase(loginFromApiAsync.fulfilled, (state, action) => {\r\n                state.status = 'idle';\r\n            })\r\n    },\r\n})\r\n\r\nexport const {\r\n    setUsername,\r\n    setPassword,\r\n    setUsernameError,\r\n    setPasswordError,\r\n    setLoggedIn,\r\n    setToken\r\n\r\n} = loginSlice.actions;\r\n\r\n// The function below is called a selector and allows us to select a value from\r\n// the state. Selectors can also be defined inline where they're used instead of\r\n// in the slice file. For example: `useSelector((state: RootState) => state.counter.value)`\r\nexport const selectLoginState = (state: RootState) => state.login\r\nexport const selectUsername = (state: RootState) => state.login.username\r\nexport const selectPassword = (state: RootState) => state.login.password\r\nexport const selectErrors = (state: RootState) => state.login.errors\r\nexport const selectUsernameErrors = (state: RootState) => state.login.errors.username\r\nexport const selectPasswordErrors = (state: RootState) => state.login.errors.password\r\nexport const selectLoggedIn = (state: RootState) => state.login.loggedIn\r\nexport const selectToken = (state: RootState) => state.login.token\r\n\r\nexport default loginSlice.reducer;","import './Upload.scss'\r\nimport {useAppDispatch, useAppSelector} from \"../hooks\";\r\nimport {\r\n    postVideo,\r\n    selectAuthor,\r\n    selectDescription,\r\n    selectFilename,\r\n    selectThumbnailGifs,\r\n    selectThumbnailGifsIndex,\r\n    selectThumbnailPngs,\r\n    selectThumbnailPngsIndex,\r\n    selectTitle,\r\n    selectUploadState,\r\n    selectVideo,\r\n    setDescription,\r\n    setFilename, setThumbnailGifs, setThumbnailPngs,\r\n    setTitle,\r\n    setVideo\r\n} from \"./uploadSlice\";\r\nimport {ChangeEvent, Dispatch, SetStateAction, useEffect, useState} from \"react\";\r\nimport {selectLoggedIn, selectToken} from \"../LoginReg/Login/loginSlice\";\r\nimport {useHistory} from \"react-router-dom\";\r\nimport \"./Upload.scss\"\r\nimport {createFFmpeg, fetchFile} from \"@ffmpeg/ffmpeg\";\r\nimport axios from \"axios\";\r\n\r\nconst ffmpeg = createFFmpeg({log: true});\r\n\r\n\r\nexport function Upload() {\r\n    const author = useAppSelector(selectAuthor)\r\n    const title = useAppSelector(selectTitle)\r\n    const description = useAppSelector(selectDescription)\r\n    const fileName = useAppSelector(selectFilename)\r\n    const video = useAppSelector(selectVideo)\r\n    const token = useAppSelector(selectToken)\r\n    const thumbnailGifsIndex = useAppSelector(selectThumbnailGifsIndex)\r\n    const thumbnailGifs = useAppSelector(selectThumbnailGifs)\r\n    const thumbnailPngsIndex = useAppSelector(selectThumbnailPngsIndex)\r\n    const thumbnailPngs = useAppSelector(selectThumbnailPngs)\r\n    const state = useAppSelector(selectUploadState)\r\n    const dispatch = useAppDispatch()\r\n    const history = useHistory()\r\n    const loggedIn = useAppSelector(selectLoggedIn)\r\n    if (!loggedIn) {\r\n        history.push(\"/login\")\r\n    }\r\n\r\n    async function handleFile(e: ChangeEvent<HTMLInputElement>) {\r\n        if (e.target.files === null || e.target.files.length < 1) return;\r\n        const file = e.target.files[0]\r\n        if (!(file.type.startsWith(\"video\"))) return;\r\n        const videoElement = document.createElement(\"video\")\r\n        videoElement.addEventListener(\"loadeddata\", () => {\r\n            convertToGif(file, videoElement.duration)\r\n        })\r\n        videoElement.src = URL.createObjectURL(new Blob([file]))\r\n        videoElement.load()\r\n\r\n        const fileReader = new FileReader()\r\n        fileReader.onload = () => {\r\n            // const videoElement = document.createElement(\"video\")\r\n            // videoElement.src = fileReader.result as string\r\n            // setTimeout(() => console.log(videoElement.duration, 2), 5000 )\r\n            dispatch(setVideo(fileReader.result as string))\r\n            dispatch(setFilename(file.name))\r\n        }\r\n        fileReader.readAsDataURL(file)\r\n    }\r\n\r\n    useEffect(() => {\r\n        load();\r\n    }, [])\r\n    const load = async () => {\r\n        if (!ffmpeg.isLoaded()) {\r\n            await ffmpeg.load();\r\n        }\r\n        // put a video for testing\r\n        axios.post(\"/test_file\", {url: \"https://groupsharetk.s3.us-west-1.amazonaws.com/videos/1625451065385+when+they+call+u+a+good+boi.webm\"}).then((file) => {\r\n            handleTestFile(file.data.data)\r\n        })\r\n\r\n    }\r\n\r\n    async function handleTestFile(file:string) {\r\n        const videoElement = document.createElement(\"video\")\r\n        videoElement.addEventListener(\"loadeddata\", () => {\r\n            convertToGif(file, videoElement.duration)\r\n        })\r\n        videoElement.src = file\r\n        videoElement.load()\r\n        dispatch(setVideo(file))\r\n        dispatch(setFilename(\"Test file.webm\"))\r\n    }\r\n\r\n    //One pass for pictures, gif is either multi pass or can't find skip frames for gif fps\r\n    const convertToGif = async (file: any, duration: number) => {\r\n        // Write the file to memory\r\n        ffmpeg.FS('writeFile', 'video.mp4', await fetchFile(file));\r\n        // Run the FFMpeg command\r\n        const num_gifs = 4\r\n        const gifs = new Array(num_gifs);\r\n        const pngs = new Array(num_gifs);\r\n        const interval = duration / (num_gifs + 1)\r\n        const fps_str = `fps=1/${interval}`\r\n        await ffmpeg.run('-i', 'video.mp4', '-vf', fps_str, '%d.png')\r\n        pngs[0] = ffmpeg.FS('readFile', '1.png')\r\n        pngs[1] = ffmpeg.FS('readFile', '2.png')\r\n        pngs[2] = ffmpeg.FS('readFile', '3.png')\r\n        pngs[3] = ffmpeg.FS('readFile', '4.png')\r\n        const start_strs = []\r\n        // //4.5s - 5.5s\r\n        for (let i = 0; i < num_gifs; i++) {\r\n            const midpoint = duration / (num_gifs + 1) * (i + 1)\r\n            const start_int = Math.max(0, midpoint - 0.5);\r\n            const end_int = Math.min(duration, midpoint + 0.5)\r\n            const start_str = start_int.toString()\r\n            start_strs.push(start_str)\r\n            const gif_name = `${i}.gif`\r\n            if (start_int + 1 < duration)\r\n                await ffmpeg.run('-i', 'video.mp4', '-t', '1', '-ss', start_str, '-f', 'gif', gif_name)\r\n            else\r\n                await ffmpeg.run('-i', 'video.mp4', '-t', (duration - end_int).toString(), '-ss', start_str, '-f', 'gif', gif_name)\r\n            gifs[i] = ffmpeg.FS('readFile', gif_name)\r\n        }\r\n        //Multi seek method from one line (4s - 6.5s) (Slower)\r\n        // await ffmpeg.run('-i', 'video.mp4', '-ss', start_strs[0], '-t', '1', '1.gif',\r\n        //     '-ss', start_strs[1], '-t', '1', '2.gif',\r\n        //     '-ss', start_strs[2], '-t', '1', '3.gif',\r\n        //     '-ss', start_strs[3], '-t', '1', '4.gif')\r\n\r\n        // TODO: Combine binary data.\r\n        // Create a URL\r\n        const gif_0 = URL.createObjectURL(new Blob([gifs[0].buffer], {type: 'image/gif'}));\r\n        const gif_1 = URL.createObjectURL(new Blob([gifs[1].buffer], {type: 'image/gif'}));\r\n        const gif_2 = URL.createObjectURL(new Blob([gifs[2].buffer], {type: 'image/gif'}));\r\n        const gif_3 = URL.createObjectURL(new Blob([gifs[3].buffer], {type: 'image/gif'}));\r\n        const png_0 = URL.createObjectURL(new Blob([pngs[0].buffer], {type: 'image/png'}));\r\n        const png_1 = URL.createObjectURL(new Blob([pngs[1].buffer], {type: 'image/png'}));\r\n        const png_2 = URL.createObjectURL(new Blob([pngs[2].buffer], {type: 'image/png'}));\r\n        const png_3 = URL.createObjectURL(new Blob([pngs[3].buffer], {type: 'image/png'}));\r\n\r\n        // dispatch(setThumbnailGifs([gif_0, gif_1, gif_2, gif_3]))\r\n        dispatch(setThumbnailGifs([gif_0, gif_1, gif_2, gif_3]))\r\n        dispatch(setThumbnailPngs([png_0, png_1, png_2, png_3]))\r\n    }\r\n\r\n    function postRequest() {\r\n        dispatch(postVideo({\r\n            state: state,\r\n            token: token,\r\n            history: history\r\n        }))\r\n\r\n    }\r\n\r\n    let videoUploadDiv = <div id={\"preview--header\"}>\r\n        <div>Preview</div>\r\n        <input type={\"file\"} accept={\"video/*\"} onChange={handleFile}/>\r\n    </div>\r\n    if (video === \"\") {\r\n        videoUploadDiv = (\r\n            <div>\r\n                <label>\r\n                    Video\r\n                    <div id={\"videoprev\"} style={{textAlign: \"end\"}}>\r\n                        {fileName}\r\n                        <input style={{color: \"black\"}} accept={\"video/*\"} type={\"file\"} onChange={handleFile}/>\r\n                    </div>\r\n                </label><br/>\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <form onSubmit={(e) => {\r\n            e.preventDefault();\r\n            postRequest()\r\n        }}>\r\n            <div id={\"form-container\"}>\r\n                <div id=\"side-spacer-left\">\r\n                </div>\r\n                <div id={\"inputs\"}>\r\n                    <label id={\"title\"}>\r\n                        Title<br/>\r\n                        <textarea value={title} onChange={(e) => {\r\n                            e.preventDefault();\r\n                            dispatch(setTitle(e.target.value))\r\n                        }}/>\r\n                    </label><br/>\r\n                    <br/>\r\n\r\n                    <label>\r\n                        Description<br/>\r\n                        <textarea value={description} onChange={(e) => {\r\n                            e.preventDefault();\r\n                            dispatch(setDescription(e.target.value))\r\n                        }} style={{height: \"120px\"}}/><br/>\r\n                    </label><br/>\r\n\r\n                    <label id={\"thumbnail\"}>\r\n                        Thumbnail<br/>\r\n                        <div id=\"thumbnail-box-area\">\r\n                            <div className={\"thumbnail-section\"}>\r\n                                <img style={{opacity: \"{}\"}} src={thumbnailPngs[0]} className={\"thumbnail-box\"}/>\r\n                                <img src={thumbnailPngs[1]} className={\"thumbnail-box\"}/>\r\n                                <img src={thumbnailPngs[2]} className={\"thumbnail-box\"}/>\r\n                                <img src={thumbnailPngs[3]} className={\"thumbnail-box\"}/>\r\n                            </div>\r\n                        </div>\r\n                    </label>\r\n\r\n                    <br/>\r\n                    <div style={{display: \"flex\", justifyContent: \"center\"}}>\r\n                        <button>Upload</button>\r\n                    </div>\r\n                </div>\r\n                <div id=\"video-right\">\r\n                    {videoUploadDiv}\r\n                    <div className={\"thumbnail-section\"}>\r\n                        <img src={thumbnailGifs[0]} className={\"thumbnail-box\"}/>\r\n                        <img src={thumbnailGifs[1]} className={\"thumbnail-box\"}/>\r\n                        <img src={thumbnailGifs[2]} className={\"thumbnail-box\"}/>\r\n                        <img src={thumbnailGifs[3]} className={\"thumbnail-box\"}/>\r\n                    </div>\r\n                </div>\r\n                <div id=\"side-spacer-right\">\r\n\r\n                </div>\r\n            </div>\r\n\r\n        </form>\r\n    )\r\n}","import {useAppDispatch, useAppSelector} from \"../hooks\";\r\nimport {getVideos, getVideosFromApiAsync, setVideos} from \"../Videos/videosSlice\";\r\nimport {Video, VideoDataResponse} from \"../Videos/VideoInterfaces\";\r\nimport {PayloadAction} from \"@reduxjs/toolkit\";\r\nimport {useEffect} from \"react\";\r\nimport {useHistory} from \"react-router-dom\";\r\nimport {setVideo} from \"../OneVideo/oneVideoSlice\";\r\nimport \"./Home.scss\"\r\n\r\nexport function Home() {\r\n    const dispatch = useAppDispatch()\r\n    const allVideos = useAppSelector(getVideos)\r\n    const history = useHistory()\r\n\r\n    useEffect(() => {\r\n        dispatch(getVideosFromApiAsync())\r\n        //Shows the format for videos\r\n    }, [])\r\n\r\n    function onClickVideo(id: string) {\r\n        history.push(`/watch/${id}`)\r\n    }\r\n\r\n    const rows = allVideos.map((video) => {\r\n        return (\r\n            <div className={\"video\"} onClick={() => onClickVideo(video._id)}>\r\n                {/*<img src={video.thumbnail}/>*/}<img\r\n                src={\"https://getuikit.com/v2/docs/images/placeholder_600x400.svg\"}/>\r\n                <div>\r\n                    {video.title} <br/>\r\n                    {video.author} <br/>\r\n                    {video.views} views <br/>\r\n                </div>\r\n            </div>\r\n        )\r\n    })\r\n    return (\r\n        <div id={\"home\"}>\r\n            <div id={\"sidebar\"}>\r\n\r\n            </div>\r\n            <div id={\"allvideos\"}>\r\n                {rows}\r\n            </div>\r\n        </div>\r\n    )\r\n}","import axios, {AxiosResponse} from \"axios\";\r\nimport {VideoDataResponse} from \"./../Videos/VideoInterfaces\";\r\n\r\nexport function getOneVideoFromAPI(id: string){\r\n    return new Promise<AxiosResponse<VideoDataResponse>>((resolve) => {\r\n        axios.get(`/api/video/one/${id}`).then((data:AxiosResponse<VideoDataResponse>) =>{\r\n            resolve(data)\r\n        })\r\n    })\r\n}","import {createAsyncThunk, createSlice, PayloadAction} from '@reduxjs/toolkit';\r\nimport {RootState, AppThunk} from '../../app/store';\r\nimport axios, {AxiosResponse} from 'axios'\r\nimport {VideoDataResponse} from \"./../Videos/VideoInterfaces\";\r\nimport {Video} from \"./../Videos/VideoInterfaces\";\r\nimport {getOneVideoFromAPI} from \"./oneVideoApi\";\r\n\r\n//Even though it's one video we use an array in order to initialize it instead of an empty dictionary\r\n//and to reuse the video data response interface from the API\r\nexport interface OneVideoState {\r\n    status: string,\r\n    video: Video[]\r\n}\r\n\r\nconst initialState: OneVideoState = {\r\n    status: \"\",\r\n    video: []\r\n};\r\n// The function below is called a thunk and allows us to perform async logic. It\r\n// can be dispatched like a regular action: `dispatch(incrementAsync(10))`. This\r\n// will call the thunk with the `dispatch` function as the first argument. Async\r\n// code can then be executed and other actions can be dispatched. Thunks are\r\n// typically used to make async requests.\r\nexport const getOneVideoFromApiAsync = createAsyncThunk(\r\n    'oneVideo/getOneVideoFromApi',\r\n    async (id:string) => {\r\n        const response = await getOneVideoFromAPI(id);\r\n        // // The value we return becomes the `fulfilled` action payload\r\n        return response.data;\r\n    }\r\n);\r\n\r\nexport const oneVideoSlice = createSlice({\r\n    name: 'upload',\r\n    initialState,\r\n    // The `reducers` field lets us define reducers and generate associated actions\r\n    reducers: {\r\n        setVideo: (state, video: PayloadAction<Video>) => {\r\n            state.video[0] = video.payload\r\n        }\r\n    },\r\n    extraReducers: (builder) => {\r\n        builder\r\n            .addCase(getOneVideoFromApiAsync.pending, (state) => {\r\n                state.status = 'loading';\r\n            })\r\n            .addCase(getOneVideoFromApiAsync.fulfilled, (state, action) => {\r\n                state.status = 'idle';\r\n                state.video = action.payload.videos;\r\n            })\r\n    },\r\n\r\n    // author: \"\",\r\n    // description: \"\",\r\n    // thumbnail: \"\",\r\n    // status: 'idle',\r\n    // title: \"\",\r\n    // url: \"\",\r\n    // video: \"\"\r\n    // getVideosReq: (state) => {\r\n    //     axios.get(\"/api/video/all\").then((data:AxiosResponse<VideoDataResponse>) => {\r\n    //         state.videos = data.data.videos\r\n    //         console.log(data)\r\n    //     })\r\n    // }\r\n})\r\n// author: \"\",\r\n//     description: \"\",\r\n//     thumbnail: \"\",\r\n//     status: 'idle',\r\n//     title: \"\",\r\n//     url: \"\",\r\n//     video: \"\"\r\nexport const {\r\n    setVideo\r\n} = oneVideoSlice.actions;\r\n\r\n// The function below is called a selector and allows us to select a value from\r\n// the state. Selectors can also be defined inline where they're used instead of\r\n// in the slice file. For example: `useSelector((state: RootState) => state.counter.value)`\r\nexport const getVideo = (state: RootState) => state.oneVideo.video;\r\n\r\n\r\nexport default oneVideoSlice.reducer;\r\n","import {useEffect} from \"react\";\r\nimport {useAppDispatch, useAppSelector} from \"../hooks\";\r\nimport {useHistory, useParams} from \"react-router-dom\";\r\nimport {getOneVideoFromApiAsync, getVideo} from \"./oneVideoSlice\";\r\nimport {getOneVideoFromAPI} from \"./oneVideoApi\";\r\nimport \"./OneVideo.scss\"\r\n\r\ninterface idParams {\r\n    id: string;\r\n}\r\n\r\nexport function OneVideo() {\r\n    const dispatch = useAppDispatch()\r\n    const history = useHistory()\r\n    const oneVideo = useAppSelector(getVideo)\r\n    const params: idParams = useParams()\r\n    useEffect(() => {\r\n        //TODO: (SEVERE) [\"data:\"] Video object in initial state (dont use async thunk especially when redirecting)\r\n        // @ts-ignore\r\n        // if (oneVideo.length === 0 || (typeof oneVideo[0] === \"string\" && oneVideo[0].startsWith(\"data:\"))){\r\n        //     dispatch(getOneVideoFromApiAsync(params.id))\r\n        // }\r\n        dispatch(getOneVideoFromApiAsync(params.id))\r\n    }, [])\r\n    if (oneVideo.length === 0) {\r\n        return (\r\n            <div>\r\n                Loading...\r\n            </div>\r\n        )\r\n    }\r\n\r\n    return (\r\n        <div id={\"container\"}>\r\n            <div id={\"onevideocontainer\"}>\r\n                <video id={\"video\"} controls>\r\n                    <source src={oneVideo[0].src} type={\"video/mp4\"}/>\r\n                </video>\r\n                <div id={\"title\"}>{oneVideo[0].title}</div>\r\n                <div id={\"description\"}><span\r\n                    style={{paddingRight: \"25px\"}}>{oneVideo[0].views} views</span>{new Date(oneVideo[0].date).toDateString()}\r\n                </div>\r\n                <div>\r\n                    <div style={{display: \"flex\", justifyContent: \"flex-end\"}}>\r\n                        {oneVideo[0].likes} likes\r\n                    </div>\r\n                    <hr/>\r\n                </div>\r\n            </div>\r\n            <div id={\"sidebar\"}>\r\n                Sidebar...\r\n            </div>\r\n\r\n\r\n        </div>\r\n    )\r\n}","import React, {ChangeEvent} from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport Axios from 'axios'\r\nimport {useAppDispatch, useAppSelector} from \"../../hooks\";\r\nimport {\r\n    selectErrors,\r\n    selectUsernameErrors,\r\n    selectPassword,\r\n    selectUsername,\r\n    setPasswordError,\r\n    setUsernameError,\r\n    selectPasswordErrors,\r\n    setUsername,\r\n    setPassword,\r\n    loginFromApiAsync,\r\n    selectLoginState,\r\n    setLoggedIn,\r\n    setToken\r\n} from \"./loginSlice\";\r\nimport {LoginResponse} from \"./LoginInterface\";\r\nimport {PayloadAction} from \"@reduxjs/toolkit\";\r\nimport {useHistory} from \"react-router-dom\";\r\n\r\nexport function Login() {\r\n    const dispatch = useAppDispatch()\r\n    const loginState = useAppSelector(selectLoginState)\r\n    const username = useAppSelector(selectUsername)\r\n    const password = useAppSelector(selectPassword)\r\n    const errorsUsername = useAppSelector(selectUsernameErrors)\r\n    const errorsPassword = useAppSelector(selectPasswordErrors)\r\n    const minUserLen = 4\r\n    const minPassLen = 4\r\n    const history = useHistory()\r\n\r\n    function handleChange(inputName: string, newStr: string) {\r\n        switch (inputName) {\r\n            case \"username\":\r\n                if (newStr.length < minUserLen) {\r\n                    dispatch(setUsernameError(`Username must be at least ${minUserLen} characters long!`))\r\n                } else {\r\n                    dispatch(setUsernameError(\"\"))\r\n                }\r\n                break\r\n            case \"password\":\r\n                if (newStr.length < minPassLen) {\r\n                    dispatch(setPasswordError(`Password must be at least ${minPassLen} characters long!`))\r\n                } else {\r\n                    dispatch(setPasswordError(\"\"))\r\n                }\r\n                break\r\n        }\r\n    }\r\n\r\n    function handleSubmit() {\r\n        if (username.length < minUserLen || password.length < minPassLen) return;\r\n        dispatch(loginFromApiAsync(loginState)).then((res:PayloadAction<LoginResponse | any>) => {\r\n            if (res.payload.status === \"successful\"){\r\n                //jwt here\r\n                localStorage.setItem(\"username\", res.payload.username)\r\n                localStorage.setItem(\"token\", res.payload.token)\r\n                localStorage.setItem(\"expiresAt\", Date.now() + res.payload.expiresIn)\r\n                //TODO: (SEVERE) HTTP COOKIE\r\n                document.cookie = res.payload.token\r\n                dispatch(setLoggedIn(true))\r\n                dispatch(setToken(res.payload.token))\r\n                history.push(\"/\")\r\n            }\r\n            else if (res.payload.status === \"wrong_password\"){\r\n                dispatch(setPasswordError(\"Incorrect Password!\"))\r\n            }\r\n            else {\r\n                dispatch(setUsernameError(\"Incorrect Login Details!\"))\r\n                dispatch(setPasswordError(\"Incorrect Login Details!\"))\r\n            }\r\n        })\r\n    }\r\n\r\n    return (\r\n        <div style={{textAlign: \"center\"}}>\r\n            <form onSubmit={(e) => {\r\n                e.preventDefault();\r\n                handleSubmit();\r\n            }}>\r\n                <label>\r\n                    Username:<br/>\r\n                    <input type={\"text\"} name={\"username\"} value={username} onChange={(e) => {\r\n                        dispatch(setUsername(e.target.value));\r\n                        handleChange(\"username\", e.target.value);\r\n                    }}/><br/>\r\n                    {errorsUsername}\r\n                </label><br/>\r\n                <label>\r\n                    Password:<br/>\r\n                    <input type={\"password\"} name={\"password\"} value={password}\r\n                           onChange={(e) => {\r\n                               dispatch(setPassword(e.target.value));\r\n                               handleChange(\"password\", e.target.value);\r\n                           }}/><br/>\r\n                    {errorsPassword}\r\n                </label><br/>\r\n                <br/>\r\n                <input type={\"submit\"} value={\"Login\"}/>\r\n            </form>\r\n        </div>\r\n    );\r\n}","import React from 'react';\nimport logo from './logo.svg';\nimport {Counter} from './features/counter/Counter';\nimport './App.scss';\nimport {SearchBar} from \"./app/SearchBar/SearchBar\";\nimport {BrowserRouter as Router, Switch, Route, Link} from \"react-router-dom\";\nimport {SearchResults} from \"./app/SearchResults/SearchResults\";\nimport {Upload} from \"./app/Upload/Upload\";\nimport {Home} from \"./app/Home/Home\";\nimport {OneVideo} from \"./app/OneVideo/OneVideo\";\nimport {Login} from \"./app/LoginReg/Login/LoginReg\";\nimport {selectLoggedIn} from \"./app/LoginReg/Login/loginSlice\";\nimport {useAppSelector} from \"./app/hooks\";\n\nfunction App() {\n\n    return (\n        <div id={\"App\"}>\n            <Router>\n                <div id={\"header\"}>\n                    <Link style={{display: \"inline-block\"}} to={\"/\"}><p\n                        id={\"logo\"}>GroupShare</p></Link>\n                    <div style={{textAlign: \"center\", paddingTop: \"7px\"}}>\n                        <SearchBar/>\n                    </div>\n                    <div style={{paddingTop: \"5px\"}}>\n                        <Link style={{display: \"inline-block\", padding: \"0 15px 0 15px\"}}\n                              to={\"/login\"}>{useAppSelector(selectLoggedIn) ? \"Switch User\" : \"Login\"}</Link>\n                        <Link style={{display: \"inline-block\", padding: \"0 15px 0 15px\"}}\n                              to={\"/upload\"}>Upload</Link>\n                    </div>\n                </div>\n                <Switch>\n                    <Route exact path={\"/\"}>\n                        <Home/>\n                    </Route>\n                    <Route exact path={\"/watch/:id\"}>\n                        <OneVideo/>\n                    </Route>\n                    <Route path={\"/results/search_query=:query\"}>\n                        <SearchResults/>\n                    </Route>\n                    <Route path={\"/login\"}>\n                        <Login/>\n                    </Route>\n                    <Route path={\"/upload\"}>\n                        <Upload/>\n                    </Route>\n\n                </Switch>\n            </Router>\n        </div>\n    )\n\n}\n\nexport default App;\n","// A mock function to mimic making an async request for data\nexport function fetchCount(amount = 1) {\n  return new Promise<{ data: number }>((resolve) =>\n    setTimeout(() => resolve({ data: amount }), 500)\n  );\n}\n","import { createAsyncThunk, createSlice, PayloadAction } from '@reduxjs/toolkit';\nimport { RootState, AppThunk } from '../../app/store';\nimport { fetchCount } from './counterAPI';\n\nexport interface CounterState {\n  value: number;\n  status: 'idle' | 'loading' | 'failed';\n}\n\nconst initialState: CounterState = {\n  value: 0,\n  status: 'idle',\n};\n\n// The function below is called a thunk and allows us to perform async logic. It\n// can be dispatched like a regular action: `dispatch(incrementAsync(10))`. This\n// will call the thunk with the `dispatch` function as the first argument. Async\n// code can then be executed and other actions can be dispatched. Thunks are\n// typically used to make async requests.\nexport const incrementAsync = createAsyncThunk(\n  'counter/fetchCount',\n  async (amount: number) => {\n    const response = await fetchCount(amount);\n    // The value we return becomes the `fulfilled` action payload\n    return response.data;\n  }\n);\n\nexport const counterSlice = createSlice({\n  name: 'counter',\n  initialState,\n  // The `reducers` field lets us define reducers and generate associated actions\n  reducers: {\n    increment: (state) => {\n      // Redux Toolkit allows us to write \"mutating\" logic in reducers. It\n      // doesn't actually mutate the state because it uses the Immer library,\n      // which detects changes to a \"draft state\" and produces a brand new\n      // immutable state based off those changes\n      state.value += 1;\n    },\n    decrement: (state) => {\n      state.value -= 1;\n    },\n    // Use the PayloadAction type to declare the contents of `action.payload`\n    incrementByAmount: (state, action: PayloadAction<number>) => {\n      state.value += action.payload;\n    },\n  },\n  // The `extraReducers` field lets the slice handle actions defined elsewhere,\n  // including actions generated by createAsyncThunk or in other slices.\n  extraReducers: (builder) => {\n    builder\n      .addCase(incrementAsync.pending, (state) => {\n        state.status = 'loading';\n      })\n      .addCase(incrementAsync.fulfilled, (state, action) => {\n        state.status = 'idle';\n        state.value += action.payload;\n      });\n  },\n});\n\nexport const { increment, decrement, incrementByAmount } = counterSlice.actions;\n\n// The function below is called a selector and allows us to select a value from\n// the state. Selectors can also be defined inline where they're used instead of\n// in the slice file. For example: `useSelector((state: RootState) => state.counter.value)`\nexport const selectCount = (state: RootState) => state.counter.value;\n\n// We can also write thunks by hand, which may contain both sync and async logic.\n// Here's an example of conditionally dispatching actions based on current state.\nexport const incrementIfOdd = (amount: number): AppThunk => (\n  dispatch,\n  getState\n) => {\n  const currentValue = selectCount(getState());\n  if (currentValue % 2 === 1) {\n    dispatch(incrementByAmount(amount));\n  }\n};\n\nexport default counterSlice.reducer;\n","import { configureStore, ThunkAction, Action } from '@reduxjs/toolkit';\nimport counterReducer from '../features/counter/counterSlice';\nimport uploadReducer from \"./Upload/uploadSlice\";\nimport videosReducer from \"./Videos/videosSlice\";\nimport oneVideoReducer from \"./OneVideo/oneVideoSlice\"\nimport loginReducer from \"./LoginReg/Login/loginSlice\"\n\nexport const store = configureStore({\n  reducer: {\n    counter: counterReducer,\n    upload: uploadReducer,\n    videos: videosReducer,\n    oneVideo: oneVideoReducer,\n    login: loginReducer\n  },\n});\n\nexport type AppDispatch = typeof store.dispatch;\nexport type RootState = ReturnType<typeof store.getState>;\nexport type AppThunk<ReturnType = void> = ThunkAction<\n  ReturnType,\n  RootState,\n  unknown,\n  Action<string>\n>;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister();\n      })\n      .catch((error) => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport { store } from './app/store';\nimport { Provider } from 'react-redux';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}