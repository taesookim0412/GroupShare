(this.webpackJsonpgroupshare=this.webpackJsonpgroupshare||[]).push([[0],{35:function(e,t,n){},46:function(e,t,n){},47:function(e,t,n){},72:function(e,t,n){},92:function(e,t,n){},93:function(e,t,n){},94:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),i=n(17),s=n.n(i),c=(n(46),n(47),n(41)),o=n(4),u=n(16),d=function(){return Object(u.b)()},l=u.c,b=n(2),p=n.n(b),j=n(6),f=n(5),h=n(13),x=n.n(h);function m(){return new Promise((function(e){x.a.get("/api/video/all").then((function(t){e(t)}))}))}function v(e){return new Promise((function(t){x.a.get("/api/video/search/".concat(e)).then((function(e){t(e)}))}))}var g=Object(f.b)("videos/getVideosFromApi",Object(j.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m();case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))),O=Object(f.b)("videos/getSearchVideosFromApi",function(){var e=Object(j.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v(t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),y=(Object(f.b)("video/getOneVideoFromApi",Object(j.a)(p.a.mark((function e(){var t;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,m();case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}}),e)})))),Object(f.c)({name:"upload",initialState:{status:"",videos:[],searchClicks:[0]},reducers:{setVideos:function(e,t){e.videos=t.payload},pushSearchClick:function(e){e.searchClicks[0]=(e.searchClicks[0]+1)%3}},extraReducers:function(e){e.addCase(g.pending,(function(e){e.status="loading"})).addCase(g.fulfilled,(function(e,t){e.status="idle",e.videos=t.payload.videos})).addCase(O.pending,(function(e,t){e.status="loading",e.videos=[]})).addCase(O.fulfilled,(function(e,t){e.status="idle",e.videos=t.payload.videos}))}})),w=y.actions,k=w.setVideos,S=w.pushSearchClick,U=function(e){return e.videos.videos},C=function(e){return e.videos.searchClicks},L=y.reducer,R=n(0);function I(){var e=Object(a.useState)(""),t=Object(c.a)(e,2),n=t[0],r=t[1],i=Object(o.f)(),s=d();return Object(R.jsx)("div",{style:{display:"inline-block",textAlign:"center"},children:Object(R.jsxs)("form",{onSubmit:function(e){e.preventDefault(),i.push("/results/search_query=".concat(encodeURIComponent(n))),s(S())},children:[Object(R.jsx)("input",{type:"text",value:n,onChange:function(e){e.preventDefault(),r(e.target.value)}}),Object(R.jsx)("button",{children:"Search"})]})})}var F=n(12);n(72);function A(){var e=Object(o.g)(),t=decodeURIComponent(e.query),n=d(),r=l(U),i=l(C),s=Object(o.f)();Object(a.useEffect)((function(){n(k([])),n(O(t))}),i);var c=r.map((function(e){return Object(R.jsxs)("div",{className:"searchrow",style:{padding:"20px 0px 20px 0px"},onClick:function(){return t=e._id,void s.push("/watch/".concat(t));var t},children:[Object(R.jsx)("img",{src:"https://getuikit.com/v2/docs/images/placeholder_600x400.svg"}),Object(R.jsxs)("div",{className:"videoinfo",children:[e.title," ",Object(R.jsx)("br",{}),e.author," ",Object(R.jsx)("br",{}),e.views," ",Object(R.jsx)("br",{})]})]})}));return Object(R.jsxs)("div",{className:"grid",children:[Object(R.jsx)("div",{id:"sidebar",children:"Sidebar"}),Object(R.jsx)("div",{id:"searchrows",children:c})]})}n(35);function P(e){for(var t=atob(e.split(",")[1]),n=new ArrayBuffer(t.length),a=new Uint8Array(n),r=0;r<t.length;r++)a[r]=t.charCodeAt(r);return new Blob([n],{type:"video/webm"})}var N=Object(f.b)("upload/postVideo",function(){var e=Object(j.a)(p.a.mark((function e(t){var n,a,r,i,s;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.state,a=t.token,r=t.history,""!==n.video){e.next=3;break}return e.abrupt("return");case 3:(i=new FormData).append("author",localStorage.username),i.append("description",n.description),i.append("thumbnail",n.thumbnailGifs[n.thumbnailGifsIndex]),i.append("status",n.status),i.append("title",n.title),i.append("url",n.url),s=P(n.video),i.append("video",s,n.fileName),x.a.post("/api/video",i,{headers:{token:a,author:localStorage.username}}).then((function(e){"successful"===e.data.status?r.push("/"):r.push("/login")}));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),T=Object(f.c)({name:"upload",initialState:{author:"",description:"",fileName:"Upload",status:"idle",thumbnailGifsIndex:"0",thumbnailGifs:["","","",""],thumbnailPngsIndex:"",thumbnailPngs:["","","",""],title:"",url:"",video:""},reducers:{setAuthor:function(e,t){e.author=t.payload},setTitle:function(e,t){e.title=t.payload},setDescription:function(e,t){e.description=t.payload},setUrl:function(e,t){e.url=t.payload},setFilename:function(e,t){e.fileName=t.payload},setThumbnailGifsIndex:function(e,t){e.thumbnailGifsIndex=t.payload},setThumbnailGifs:function(e,t){e.thumbnailGifs=t.payload},setThumbnailPngsIndex:function(e,t){e.thumbnailPngsIndex=t.payload},setThumbnailPngs:function(e,t){e.thumbnailPngs=t.payload},setStatus:function(e,t){e.status=t.payload},setVideo:function(e,t){e.video=t.payload}}}),D=T.actions,B=(D.setAuthor,D.setDescription),V=D.setFilename,E=(D.setStatus,D.setThumbnailGifsIndex,D.setThumbnailGifs),G=(D.setThumbnailPngsIndex,D.setThumbnailPngs),_=D.setTitle,q=(D.setUrl,D.setVideo),M=function(e){return e.upload.author},W=function(e){return e.upload.description},J=function(e){return e.upload.fileName},z=function(e){return e.upload.thumbnailGifsIndex},$=function(e){return e.upload.thumbnailGifs},H=function(e){return e.upload.thumbnailPngsIndex},K=function(e){return e.upload.thumbnailPngs},Q=function(e){return e.upload.title},X=function(e){return e.upload},Y=function(e){return e.upload.video},Z=T.reducer;function ee(e,t){return new Promise((function(n){x.a.post("api/login/login",{username:e,password:t}).then((function(e){n(e)}))}))}var te={status:"",username:"user",password:"pass",errors:{username:"",password:""},loggedIn:!(void 0===localStorage.expiresAt||localStorage.expiresAt<Date.now())||(document.cookie="",!1),token:localStorage.username||document.cookie?document.cookie:""};var ne=Object(f.b)("login/loginFromApi",function(){var e=Object(j.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ee(t.username,t.password);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),ae=Object(f.c)({name:"login",initialState:te,reducers:{setUsername:function(e,t){e.username=t.payload},setPassword:function(e,t){e.password=t.payload},setUsernameError:function(e,t){e.errors.username=t.payload},setPasswordError:function(e,t){e.errors.password=t.payload},setLoggedIn:function(e,t){e.loggedIn=t.payload},setToken:function(e,t){e.token=t.payload}},extraReducers:function(e){e.addCase(ne.pending,(function(e){e.status="loading"})).addCase(ne.fulfilled,(function(e,t){e.status="idle"}))}}),re=ae.actions,ie=re.setUsername,se=re.setPassword,ce=re.setUsernameError,oe=re.setPasswordError,ue=re.setLoggedIn,de=re.setToken,le=function(e){return e.login},be=function(e){return e.login.username},pe=function(e){return e.login.password},je=function(e){return e.login.errors.username},fe=function(e){return e.login.errors.password},he=function(e){return e.login.loggedIn},xe=function(e){return e.login.token},me=ae.reducer,ve=n(25),ge=Object(ve.createFFmpeg)({log:!0});function Oe(){l(M);var e=l(Q),t=l(W),n=l(J),r=l(Y),i=l(xe),s=(l(z),l($)),c=(l(H),l(K)),u=l(X),b=d(),f=Object(o.f)();function h(e){return m.apply(this,arguments)}function m(){return(m=Object(j.a)(p.a.mark((function e(t){var n,a,r;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null===t.target.files||t.target.files.length<1)){e.next=2;break}return e.abrupt("return");case 2:if((n=t.target.files[0]).type.startsWith("video")){e.next=5;break}return e.abrupt("return");case 5:(a=document.createElement("video")).addEventListener("loadeddata",(function(){y(n,a.duration)})),a.src=URL.createObjectURL(new Blob([n])),a.load(),(r=new FileReader).onload=function(){b(q(r.result)),b(V(n.name))},r.readAsDataURL(n);case 12:case"end":return e.stop()}}),e)})))).apply(this,arguments)}l(he)||f.push("/login"),Object(a.useEffect)((function(){v()}),[]);var v=function(){var e=Object(j.a)(p.a.mark((function e(){return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(ge.isLoaded()){e.next=3;break}return e.next=3,ge.load();case 3:x.a.post("/test_file",{url:"https://groupsharetk.s3.us-west-1.amazonaws.com/videos/1625451065385+when+they+call+u+a+good+boi.webm"}).then((function(e){g(e.data.data)}));case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();function g(e){return O.apply(this,arguments)}function O(){return(O=Object(j.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(n=document.createElement("video")).addEventListener("loadeddata",(function(){y(t,n.duration)})),n.src=t,n.load(),b(q(t)),b(V("Test file.webm"));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=function(){var e=Object(j.a)(p.a.mark((function e(t,n){var a,r,i,s,c,o,u,d,l,j,f,h,x,m,v,g,O,y,w;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=ge,e.next=3,Object(ve.fetchFile)(t);case 3:return e.t1=e.sent,e.t0.FS.call(e.t0,"writeFile","video.mp4",e.t1),a=4,r=new Array(a),i=new Array(a),s="fps=1/".concat(n/(a+1)),e.next=12,ge.run("-i","video.mp4","-vf",s,"%d.png");case 12:i[0]=ge.FS("readFile","1.png"),i[1]=ge.FS("readFile","2.png"),i[2]=ge.FS("readFile","3.png"),i[3]=ge.FS("readFile","4.png"),c=[],o=0;case 18:if(!(o<a)){e.next=36;break}if(u=n/(a+1)*(o+1),d=Math.max(0,u-.5),l=Math.min(n,u+.5),j=d.toString(),c.push(j),f="".concat(o,".gif"),!(d+1<n)){e.next=30;break}return e.next=28,ge.run("-i","video.mp4","-t","1","-ss",j,"-f","gif",f);case 28:e.next=32;break;case 30:return e.next=32,ge.run("-i","video.mp4","-t",(n-l).toString(),"-ss",j,"-f","gif",f);case 32:r[o]=ge.FS("readFile",f);case 33:o++,e.next=18;break;case 36:h=URL.createObjectURL(new Blob([r[0].buffer],{type:"image/gif"})),x=URL.createObjectURL(new Blob([r[1].buffer],{type:"image/gif"})),m=URL.createObjectURL(new Blob([r[2].buffer],{type:"image/gif"})),v=URL.createObjectURL(new Blob([r[3].buffer],{type:"image/gif"})),g=URL.createObjectURL(new Blob([i[0].buffer],{type:"image/png"})),O=URL.createObjectURL(new Blob([i[1].buffer],{type:"image/png"})),y=URL.createObjectURL(new Blob([i[2].buffer],{type:"image/png"})),w=URL.createObjectURL(new Blob([i[3].buffer],{type:"image/png"})),b(E([h,x,m,v])),b(G([g,O,y,w]));case 46:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}();var w=Object(R.jsxs)("div",{id:"preview--header",children:[Object(R.jsx)("div",{children:"Preview"}),Object(R.jsx)("input",{type:"file",accept:"video/*",onChange:h})]});return""===r&&(w=Object(R.jsxs)("div",{children:[Object(R.jsxs)("label",{children:["Video",Object(R.jsxs)("div",{id:"videoprev",style:{textAlign:"end"},children:[n,Object(R.jsx)("input",{style:{color:"black"},accept:"video/*",type:"file",onChange:h})]})]}),Object(R.jsx)("br",{})]})),Object(R.jsx)("form",{onSubmit:function(e){e.preventDefault(),b(N({state:u,token:i,history:f}))},children:Object(R.jsxs)("div",{id:"form-container",children:[Object(R.jsx)("div",{id:"side-spacer-left"}),Object(R.jsxs)("div",{id:"inputs",children:[Object(R.jsxs)("label",{id:"title",children:["Title",Object(R.jsx)("br",{}),Object(R.jsx)("textarea",{value:e,onChange:function(e){e.preventDefault(),b(_(e.target.value))}})]}),Object(R.jsx)("br",{}),Object(R.jsx)("br",{}),Object(R.jsxs)("label",{children:["Description",Object(R.jsx)("br",{}),Object(R.jsx)("textarea",{value:t,onChange:function(e){e.preventDefault(),b(B(e.target.value))},style:{height:"120px"}}),Object(R.jsx)("br",{})]}),Object(R.jsx)("br",{}),Object(R.jsxs)("label",{id:"thumbnail",children:["Thumbnail",Object(R.jsx)("br",{}),Object(R.jsx)("div",{id:"thumbnail-box-area",children:Object(R.jsxs)("div",{className:"thumbnail-section",children:[Object(R.jsx)("img",{style:{opacity:"{}"},src:c[0],className:"thumbnail-box"}),Object(R.jsx)("img",{src:c[1],className:"thumbnail-box"}),Object(R.jsx)("img",{src:c[2],className:"thumbnail-box"}),Object(R.jsx)("img",{src:c[3],className:"thumbnail-box"})]})})]}),Object(R.jsx)("br",{}),Object(R.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(R.jsx)("button",{children:"Upload"})})]}),Object(R.jsxs)("div",{id:"video-right",children:[w,Object(R.jsxs)("div",{className:"thumbnail-section",children:[Object(R.jsx)("img",{src:s[0],className:"thumbnail-box"}),Object(R.jsx)("img",{src:s[1],className:"thumbnail-box"}),Object(R.jsx)("img",{src:s[2],className:"thumbnail-box"}),Object(R.jsx)("img",{src:s[3],className:"thumbnail-box"})]})]}),Object(R.jsx)("div",{id:"side-spacer-right"})]})})}n(92);function ye(){var e=d(),t=l(U),n=Object(o.f)();Object(a.useEffect)((function(){e(g())}),[]);var r=t.map((function(e){return Object(R.jsxs)("div",{className:"video",onClick:function(){return t=e._id,void n.push("/watch/".concat(t));var t},children:[Object(R.jsx)("img",{src:"https://getuikit.com/v2/docs/images/placeholder_600x400.svg"}),Object(R.jsxs)("div",{children:[e.title," ",Object(R.jsx)("br",{}),e.author," ",Object(R.jsx)("br",{}),e.views," views ",Object(R.jsx)("br",{})]})]})}));return Object(R.jsxs)("div",{id:"home",children:[Object(R.jsx)("div",{id:"sidebar"}),Object(R.jsx)("div",{id:"allvideos",children:r})]})}function we(e){return new Promise((function(t){x.a.get("/api/video/one/".concat(e)).then((function(e){t(e)}))}))}var ke=Object(f.b)("oneVideo/getOneVideoFromApi",function(){var e=Object(j.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we(t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Se=Object(f.c)({name:"upload",initialState:{status:"",video:[]},reducers:{setVideo:function(e,t){e.video[0]=t.payload}},extraReducers:function(e){e.addCase(ke.pending,(function(e){e.status="loading"})).addCase(ke.fulfilled,(function(e,t){e.status="idle",e.video=t.payload.videos}))}}),Ue=(Se.actions.setVideo,function(e){return e.oneVideo.video}),Ce=Se.reducer;n(93);function Le(){var e=d(),t=(Object(o.f)(),l(Ue)),n=Object(o.g)();return Object(a.useEffect)((function(){e(ke(n.id))}),[]),0===t.length?Object(R.jsx)("div",{children:"Loading..."}):Object(R.jsxs)("div",{id:"container",children:[Object(R.jsxs)("div",{id:"onevideocontainer",children:[Object(R.jsx)("video",{id:"video",controls:!0,children:Object(R.jsx)("source",{src:t[0].src,type:"video/mp4"})}),Object(R.jsx)("div",{id:"title",children:t[0].title}),Object(R.jsxs)("div",{id:"description",children:[Object(R.jsxs)("span",{style:{paddingRight:"25px"},children:[t[0].views," views"]}),new Date(t[0].date).toDateString()]}),Object(R.jsxs)("div",{children:[Object(R.jsxs)("div",{style:{display:"flex",justifyContent:"flex-end"},children:[t[0].likes," likes"]}),Object(R.jsx)("hr",{})]})]}),Object(R.jsx)("div",{id:"sidebar",children:"Sidebar..."})]})}function Re(){var e=d(),t=l(le),n=l(be),a=l(pe),r=l(je),i=l(fe),s=Object(o.f)();function c(t,n){switch(t){case"username":n.length<4?e(ce("Username must be at least ".concat(4," characters long!"))):e(ce(""));break;case"password":n.length<4?e(oe("Password must be at least ".concat(4," characters long!"))):e(oe(""))}}return Object(R.jsx)("div",{style:{textAlign:"center"},children:Object(R.jsxs)("form",{onSubmit:function(r){r.preventDefault(),n.length<4||a.length<4||e(ne(t)).then((function(t){"successful"===t.payload.status?(localStorage.setItem("username",t.payload.username),localStorage.setItem("token",t.payload.token),localStorage.setItem("expiresAt",Date.now()+t.payload.expiresIn),document.cookie=t.payload.token,e(ue(!0)),e(de(t.payload.token)),s.push("/")):"wrong_password"===t.payload.status?e(oe("Incorrect Password!")):(e(ce("Incorrect Login Details!")),e(oe("Incorrect Login Details!")))}))},children:[Object(R.jsxs)("label",{children:["Username:",Object(R.jsx)("br",{}),Object(R.jsx)("input",{type:"text",name:"username",value:n,onChange:function(t){e(ie(t.target.value)),c("username",t.target.value)}}),Object(R.jsx)("br",{}),r]}),Object(R.jsx)("br",{}),Object(R.jsxs)("label",{children:["Password:",Object(R.jsx)("br",{}),Object(R.jsx)("input",{type:"password",name:"password",value:a,onChange:function(t){e(se(t.target.value)),c("password",t.target.value)}}),Object(R.jsx)("br",{}),i]}),Object(R.jsx)("br",{}),Object(R.jsx)("br",{}),Object(R.jsx)("input",{type:"submit",value:"Login"})]})})}var Ie=function(){return Object(R.jsx)("div",{id:"App",children:Object(R.jsxs)(F.a,{children:[Object(R.jsxs)("div",{id:"header",children:[Object(R.jsx)(F.b,{style:{display:"inline-block"},to:"/",children:Object(R.jsx)("p",{id:"logo",children:"GroupShare"})}),Object(R.jsx)("div",{style:{textAlign:"center",paddingTop:"7px"},children:Object(R.jsx)(I,{})}),Object(R.jsxs)("div",{style:{paddingTop:"5px"},children:[Object(R.jsx)(F.b,{style:{display:"inline-block",padding:"0 15px 0 15px"},to:"/login",children:l(he)?"Switch User":"Login"}),Object(R.jsx)(F.b,{style:{display:"inline-block",padding:"0 15px 0 15px"},to:"/upload",children:"Upload"})]})]}),Object(R.jsxs)(o.c,{children:[Object(R.jsx)(o.a,{exact:!0,path:"/",children:Object(R.jsx)(ye,{})}),Object(R.jsx)(o.a,{exact:!0,path:"/watch/:id",children:Object(R.jsx)(Le,{})}),Object(R.jsx)(o.a,{path:"/results/search_query=:query",children:Object(R.jsx)(A,{})}),Object(R.jsx)(o.a,{path:"/login",children:Object(R.jsx)(Re,{})}),Object(R.jsx)(o.a,{path:"/upload",children:Object(R.jsx)(Oe,{})})]})]})})};function Fe(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return new Promise((function(t){return setTimeout((function(){return t({data:e})}),500)}))}var Ae=Object(f.b)("counter/fetchCount",function(){var e=Object(j.a)(p.a.mark((function e(t){var n;return p.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Fe(t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),Pe=Object(f.c)({name:"counter",initialState:{value:0,status:"idle"},reducers:{increment:function(e){e.value+=1},decrement:function(e){e.value-=1},incrementByAmount:function(e,t){e.value+=t.payload}},extraReducers:function(e){e.addCase(Ae.pending,(function(e){e.status="loading"})).addCase(Ae.fulfilled,(function(e,t){e.status="idle",e.value+=t.payload}))}}),Ne=Pe.actions,Te=(Ne.increment,Ne.decrement,Ne.incrementByAmount,Pe.reducer),De=Object(f.a)({reducer:{counter:Te,upload:Z,videos:L,oneVideo:Ce,login:me}});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(Object(R.jsx)(r.a.StrictMode,{children:Object(R.jsx)(u.a,{store:De,children:Object(R.jsx)(Ie,{})})}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[94,1,2]]]);
//# sourceMappingURL=main.e3b621c8.chunk.js.map